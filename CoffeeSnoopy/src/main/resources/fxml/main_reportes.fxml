<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.geometry.Insets?>
<?import javafx.scene.chart.*?>

<BorderPane prefHeight="700.0" prefWidth="1000.0" xmlns="http://javafx.com/javafx/17.0.12"
            xmlns:fx="http://javafx.com/fxml/1"
            fx:controller="pe.edu.upeu.CafeSnoopy.control.ReportesController">

    <top>
        <VBox spacing="15" style="-fx-padding: 20; -fx-background-color: #2c3e50;">
            <Label text="ðŸ“Š SISTEMA DE REPORTES AVANZADO"
                   style="-fx-font-size: 24px; -fx-font-weight: bold; -fx-text-fill: white;"/>

            <HBox spacing="15" alignment="CENTER_LEFT">
                <!-- COMBOBOX CORREGIDO -->
                <ComboBox fx:id="comboTipoReporte" promptText="ðŸ“ˆ Tipo de Reporte" prefWidth="200" style="-fx-font-size: 14px;"/>

                <DatePicker promptText="ðŸ“… Fecha Inicio" prefWidth="150"/>
                <DatePicker promptText="ðŸ“… Fecha Fin" prefWidth="150"/>

                <Button text="ðŸ” Generar Reporte"
                        style="-fx-background-color: #3498db; -fx-text-fill: white; -fx-font-size: 14px; -fx-padding: 10 20; -fx-font-weight: bold;"/>

                <Button text="ðŸ“„ Exportar PDF"
                        style="-fx-background-color: #e74c3c; -fx-text-fill: white; -fx-font-size: 14px; -fx-padding: 10 20;"/>

                <Button text="ðŸ’¾ Exportar Excel"
                        style="-fx-background-color: #27ae60; -fx-text-fill: white; -fx-font-size: 14px; -fx-padding: 10 20;"/>
            </HBox>
        </VBox>
    </top>

    <center>
        <TabPane tabClosingPolicy="UNAVAILABLE">
            <!-- PestaÃ±a 1: Dashboard Principal -->
            <Tab text="ðŸ  Dashboard">
                <content>
                    <ScrollPane fitToWidth="true" fitToHeight="true">
                        <VBox spacing="20" style="-fx-padding: 20;">
                            <!-- Tarjetas de MÃ©tricas RÃ¡pidas -->
                            <HBox spacing="20" alignment="CENTER">
                                <VBox spacing="10" style="-fx-padding: 20; -fx-background-color: #e8f6f3; -fx-background-radius: 15; -fx-pref-width: 200;">
                                    <Label text="ðŸ’° Ventas Hoy" style="-fx-font-size: 14px; -fx-text-fill: #2c3e50;"/>
                                    <Label text="S/ 1,845.00" style="-fx-font-size: 24px; -fx-font-weight: bold; -fx-text-fill: #27ae60;"/>
                                    <Label text="â†‘ 12% vs ayer" style="-fx-font-size: 12px; -fx-text-fill: #27ae60;"/>
                                </VBox>

                                <VBox spacing="10" style="-fx-padding: 20; -fx-background-color: #fef9e7; -fx-background-radius: 15; -fx-pref-width: 200;">
                                    <Label text="ðŸ‘¥ Clientes Atendidos" style="-fx-font-size: 14px; -fx-text-fill: #2c3e50;"/>
                                    <Label text="67" style="-fx-font-size: 24px; -fx-font-weight: bold; -fx-text-fill: #f39c12;"/>
                                    <Label text="â†‘ 8% vs ayer" style="-fx-font-size: 12px; -fx-text-fill: #27ae60;"/>
                                </VBox>

                                <VBox spacing="10" style="-fx-padding: 20; -fx-background-color: #eaf2f8; -fx-background-radius: 15; -fx-pref-width: 200;">
                                    <Label text="ðŸ“¦ Productos Vendidos" style="-fx-font-size: 14px; -fx-text-fill: #2c3e50;"/>
                                    <Label text="189" style="-fx-font-size: 24px; -fx-font-weight: bold; -fx-text-fill: #2980b9;"/>
                                    <Label text="â†‘ 15% vs ayer" style="-fx-font-size: 12px; -fx-text-fill: #27ae60;"/>
                                </VBox>

                                <VBox spacing="10" style="-fx-padding: 20; -fx-background-color: #f4ecf7; -fx-background-radius: 15; -fx-pref-width: 200;">
                                    <Label text="ðŸ“Š Ticket Promedio" style="-fx-font-size: 14px; -fx-text-fill: #2c3e50;"/>
                                    <Label text="S/ 27.54" style="-fx-font-size: 24px; -fx-font-weight: bold; -fx-text-fill: #8e44ad;"/>
                                    <Label text="â†‘ 5% vs ayer" style="-fx-font-size: 12px; -fx-text-fill: #27ae60;"/>
                                </VBox>
                            </HBox>

                            <!-- GrÃ¡ficos Principales -->
                            <HBox spacing="20">
                                <VBox spacing="10" style="-fx-pref-width: 480;">
                                    <Label text="ðŸ“ˆ Ventas de la Semana" style="-fx-font-size: 16px; -fx-font-weight: bold;"/>
                                    <BarChart fx:id="barChartVentas" prefHeight="300" prefWidth="480">
                                        <xAxis>
                                            <CategoryAxis label="DÃ­as" />
                                        </xAxis>
                                        <yAxis>
                                            <NumberAxis label="Ventas (S/)" />
                                        </yAxis>
                                    </BarChart>
                                </VBox>

                                <VBox spacing="10" style="-fx-pref-width: 480;">
                                    <Label text="ðŸ¥§ DistribuciÃ³n por CategorÃ­a" style="-fx-font-size: 16px; -fx-font-weight: bold;"/>
                                    <PieChart fx:id="pieChartCategorias" prefHeight="300" prefWidth="480"/>
                                </VBox>
                            </HBox>

                            <!-- Tabla de Productos MÃ¡s Vendidos -->
                            <VBox spacing="10">
                                <Label text="ðŸ”¥ Productos MÃ¡s Vendidos Hoy" style="-fx-font-size: 16px; -fx-font-weight: bold;"/>
                                <TableView prefHeight="200">
                                    <columns>
                                        <TableColumn text="Producto" prefWidth="200"/>
                                        <TableColumn text="CategorÃ­a" prefWidth="150"/>
                                        <TableColumn text="Cantidad" prefWidth="100"/>
                                        <TableColumn text="Total Vendido" prefWidth="150"/>
                                    </columns>
                                </TableView>
                            </VBox>
                        </VBox>
                    </ScrollPane>
                </content>
            </Tab>

            <!-- PestaÃ±a 2: Reportes Detallados -->
            <Tab text="ðŸ“‹ Reportes Detallados">
                <content>
                    <VBox spacing="15" style="-fx-padding: 20;">
                        <Label text="ðŸ“‘ Reporte de Ventas Detallado" style="-fx-font-size: 20px; -fx-font-weight: bold;"/>

                        <TableView prefHeight="400">
                            <columns>
                                <TableColumn text="Fecha" prefWidth="100"/>
                                <TableColumn text="Hora" prefWidth="80"/>
                                <TableColumn text="NÂ° Venta" prefWidth="80"/>
                                <TableColumn text="Cliente" prefWidth="150"/>
                                <TableColumn text="Productos" prefWidth="200"/>
                                <TableColumn text="Total" prefWidth="100"/>
                                <TableColumn text="Vendedor" prefWidth="120"/>
                                <TableColumn text="Estado" prefWidth="80"/>
                            </columns>
                        </TableView>

                        <!-- Resumen -->
                        <HBox spacing="30" alignment="CENTER" style="-fx-padding: 20; -fx-background-color: #ecf0f1; -fx-background-radius: 10;">
                            <VBox spacing="5" alignment="CENTER">
                                <Label text="TOTAL PERÃODO" style="-fx-font-weight: bold;"/>
                                <Label text="S/ 15,847.00" style="-fx-font-size: 18px; -fx-font-weight: bold; -fx-text-fill: #27ae60;"/>
                            </VBox>
                            <VBox spacing="5" alignment="CENTER">
                                <Label text="VENTAS TOTALES" style="-fx-font-weight: bold;"/>
                                <Label text="576" style="-fx-font-size: 18px; -fx-font-weight: bold; -fx-text-fill: #3498db;"/>
                            </VBox>
                            <VBox spacing="5" alignment="CENTER">
                                <Label text="PRODUCTOS VENDIDOS" style="-fx-font-weight: bold;"/>
                                <Label text="2,145" style="-fx-font-size: 18px; -fx-font-weight: bold; -fx-text-fill: #e67e22;"/>
                            </VBox>
                        </HBox>
                    </VBox>
                </content>
            </Tab>

            <!-- PestaÃ±a 3: AnÃ¡lisis -->
            <Tab text="ðŸ” AnÃ¡lisis">
                <content>
                    <ScrollPane fitToWidth="true" fitToHeight="true">
                        <VBox spacing="20" style="-fx-padding: 20;">
                            <Label text="ðŸ“Š AnÃ¡lisis de Tendencia Mensual" style="-fx-font-size: 20px; -fx-font-weight: bold;"/>

                            <LineChart fx:id="lineChartTendencia" prefHeight="300" prefWidth="900">
                                <xAxis>
                                    <CategoryAxis label="Meses" />
                                </xAxis>
                                <yAxis>
                                    <NumberAxis label="Ventas (S/)" />
                                </yAxis>
                            </LineChart>

                            <HBox spacing="20">
                                <VBox spacing="15" style="-fx-padding: 20; -fx-background-color: #f8f9fa; -fx-background-radius: 10; -fx-pref-width: 430;">
                                    <Label text="ðŸŽ¯ MÃ©tricas de DesempeÃ±o" style="-fx-font-size: 16px; -fx-font-weight: bold;"/>
                                    <Label text="â€¢ Horario Pico: 12:00 - 14:00"/>
                                    <Label text="â€¢ Producto Estrella: CafÃ© Americano"/>
                                    <Label text="â€¢ Vendedor Destacado: MarÃ­a GonzÃ¡lez"/>
                                    <Label text="â€¢ CategorÃ­a MÃ¡s Rentable: Bebidas Calientes"/>
                                </VBox>

                                <VBox spacing="15" style="-fx-padding: 20; -fx-background-color: #f8f9fa; -fx-background-radius: 10; -fx-pref-width: 430;">
                                    <Label text="ðŸ“ˆ Recomendaciones" style="-fx-font-size: 16px; -fx-font-weight: bold;"/>
                                    <Label text="â€¢ Incrementar stock de CafÃ© Americano"/>
                                    <Label text="â€¢ Promocionar bebidas frÃ­as en horario tarde"/>
                                    <Label text="â€¢ CapacitaciÃ³n en ventas cruzadas"/>
                                    <Label text="â€¢ Optimizar horarios de personal"/>
                                </VBox>
                            </HBox>
                        </VBox>
                    </ScrollPane>
                </content>
            </Tab>
        </TabPane>
    </center>

    <bottom>
        <HBox spacing="15" style="-fx-padding: 10; -fx-background-color: #34495e; -fx-alignment: CENTER_LEFT;">
            <Label text="ðŸŸ¢ Sistema conectado" style="-fx-text-fill: white; -fx-font-size: 12px;"/>
            <Separator orientation="VERTICAL" style="-fx-padding: 0 10;"/>
            <Label text="ðŸ“Š Ãšltima actualizaciÃ³n: 12:45 PM" style="-fx-text-fill: white; -fx-font-size: 12px;"/>
            <Separator orientation="VERTICAL" style="-fx-padding: 0 10;"/>
            <Label text="ðŸ‘¤ Usuario: Admin" style="-fx-text-fill: white; -fx-font-size: 12px;"/>
            <Separator orientation="VERTICAL" style="-fx-padding: 0 10;"/>
            <Label text="ðŸ’¾ PerÃ­odo: 01/01/2025 - 31/01/2025" style="-fx-text-fill: white; -fx-font-size: 12px;"/>
        </HBox>
    </bottom>
</BorderPane>